from gmpy2 import mpz, iroot
from Crypto.Util.number import long_to_bytes

array = [
    '1606445403065636568810819012599363739676373972401733824562262979393720047441345203331510155323684858474862700641924718626114438041849478877234538720217992366840671654767522379536279527364801782576955917505837079849297281000',
    '194846896547609034061072134079933809195361179466485870842674220305398915048308913277399590416222419090569240139825659087273877107018706499444214997532905136030233571673088796155114618610930456896162923421855989754400134611102282107158959888295838953629',
    '210428273666574987439588816554333702685009792138851787465927117739717679010259365905977055952663918087055397692812673224606017309023090398232201170687062552370980088634372633167406221328465484344822986293438099433384982017642465336221883216352411386209',
    '34960526826403112919414403604978723920639168286799039051382736811763319314775281071957018975100737418258942535165713475059296533080759750255833322314494518625'
]
e = 3

for i in array:
    m = mpz(i)
    res, is_exact = iroot(m, e)
    if is_exact:
        print(f"{e}-th root: {res}")
        pt_bytes = long_to_bytes(res)
        print(f"Plaintext: {pt_bytes}")
    else:
        print("Cube root is not exact")
